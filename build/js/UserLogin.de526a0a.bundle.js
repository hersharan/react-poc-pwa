(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{514:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return s}),a.d(t,"c",function(){return c}),a.d(t,"e",function(){return l}),a.d(t,"d",function(){return u});var n=a(2),r=a(1),o=a.n(r);function i(e,t){var a=e,r=[];return t&&0!==t.length||(r=e),t&&t.length>0&&e&&e.length>0&&a.forEach(function(e){var a=null;Object.prototype.hasOwnProperty.call(e,"userBookmarkStatus")||Object.prototype.hasOwnProperty.call(e,"userFavouriteStatus")||Object.prototype.hasOwnProperty.call(e,"favourites")||Object.prototype.hasOwnProperty.call(e,"bookmarks")||Object.prototype.hasOwnProperty.call(e,"status")?a=e:t.forEach(function(t){(Object.prototype.hasOwnProperty.call(e,"nid")&&e.nid===t.nid||Object.prototype.hasOwnProperty.call(e,"tid")&&e.tid===t.tid)&&(a=Object(n.a)({},e,t))}),r.push(a)}),r}function s(){return window.innerWidth<769?"xs":window.innerWidth<992&&window.innerWidth>768?"sm":window.innerWidth<1199&&window.innerWidth>991?"md":"lg"}function c(){return o.a.createElement("span",{className:"inline-loading"},o.a.createElement("span",null,"."),o.a.createElement("span",null,"."),o.a.createElement("span",null,"."))}function l(e,t){var a=e;return a&&0===a.length?t:t&&0!==t.length?(t.forEach(function(t,n){e.forEach(function(e,n){t.nid===e.nid&&(a[n]=t)})}),a):void 0}function u(){var e=localStorage.getItem("user"),t=JSON.parse(e);t&&!t.policyFlag&&document.getElementById("toolbar-administration")&&document.getElementById("toolbar-administration").remove()}},523:function(e,t,a){},524:function(e,t,a){e.exports=a.p+"images/Logo.31e15bfe.svg"},525:function(e,t,a){"use strict";var n=a(1),r=a.n(n),o=(a(523),a(524)),i=a.n(o);t.a=function(){return r.a.createElement("header",{className:"col-12 top-header"},r.a.createElement("div",{className:"logo text-center"},r.a.createElement("a",{href:"/login"},r.a.createElement("img",{src:i.a,alt:"Aramis and Designer Fragrances"}))))}},526:function(e,t,a){"use strict";var n=a(48),r=a.n(n),o=a(69);var i={getLoginBackground:function(){return function(e){e({type:"FETCH_LOGIN_BACKGROUND"}),r.a.get("/api/v1/loginBackgroundImage?_format=json").then(function(t){e({type:"FETCH_LOGIN_BACKGROUND_SUCCESS",payload:t.data})}).catch(function(t){e({type:"FETCH_LOGIN_BACKGROUND_FAILURE",payload:t}),e({type:"ADD_ERROR",payload:t})})}},submitLogin:function(e,t){return Object(o.d)(),function(a){a({type:"USER_LOGIN"}),r.a.post("/api/v1/login?_format=json",{username:e,password:t}).then(function(e){Object(o.b)(e.data),a({type:"USER_LOGIN_SUCCESS",payload:e.data})}).catch(function(e){a({type:"USER_LOGIN_FAILURE",payload:e.response}),a({type:"ADD_ERROR",payload:e})})}}};t.a=i},527:function(e,t,a){},528:function(e,t,a){},529:function(e,t,a){"use strict";var n=a(48),r=a.n(n),o=a(69),i=Object(o.a)();var s={getGlobalSupportEmail:function(){return function(e){e({type:"FETCH_GLOBAL_SUPPORT_EMAIL"}),r.a.get("/api/v1/globalSupportEmail?_format=json").then(function(t){e({type:"FETCH_GLOBAL_SUPPORT_EMAIL_SUCCESS",payload:t.data})}).catch(function(t){e({type:"FETCH_GLOBAL_SUPPORT_EMAIL_FAILURE",payload:t.response}),e({type:"ADD_ERROR",payload:t})})}},getUserSupportEmail:function(){return function(e){e({type:"FETCH_USER_SUPPORT_EMAIL"}),r.a.get("/api/v1/supportEmail?_format=json",i).then(function(t){e({type:"FETCH_USER_SUPPORT_EMAIL_SUCCESS",payload:t.data})}).catch(function(t){e({type:"FETCH_USER_SUPPORT_EMAIL_FAILURE",payload:t.response}),e({type:"ADD_ERROR",payload:t})})}}};t.a=s},530:function(e,t,a){"use strict";var n=a(48),r=a.n(n),o=a(49),i=a.n(o),s=a(69),c=a(149);var l={submitLogout:function(){var e=i.a.load("access_token"),t=e&&e.accessToken;return localStorage.clear(),function(e){e({type:"USER_LOGOUT"}),r.a.get("/session/token").then(function(a){r.a.post("/api/v1/logout?_format=json",{token:t},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t),"X-CSRF-Token":a.data}}).then(function(t){e({type:"USER_LOGOUT_SUCCESS",payload:t.data}),200===t.status&&(Object(s.d)(),document.location="/login")}).catch(function(t){e({type:"USER_LOGOUT_FAILURE",payload:t.response}),e({type:"ADD_ERROR",payload:t}),document.location=c.b})})}}};t.a=l},561:function(e,t,a){"use strict";a.r(t);var n=a(64),r=a(65),o=a(67),i=a(66),s=a(68),c=a(1),l=a.n(c),u=a(87),d=a(49),p=a.n(d),g=a(501),m=a(526),h=a(80),f=a(490),E=a(152),b=a(497),y=a(498),S=a(7),v=a.n(S),O=a(491),L=a.n(O),U=a(514),_=a(150),k=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).handleLoginSubmit=function(e){if(a.setState({loginData:e}),a.state.remember){var t=L.a.AES.encrypt(JSON.stringify(e),"secret key 123");p.a.save("remember",t.toString(),{path:"/"})}else p.a.remove("remember",{path:"/"});a.props.login(e.email,e.password)},a.toggleCheckbox=function(e){var t=document.getElementById(e.target.id).checked;a.setState({remember:t})},a.state={show:!0,loginData:{},remember:!1,email:"",password:""},a.handleLoginSubmit=a.handleLoginSubmit.bind(Object(h.a)(Object(h.a)(a))),a.toggleCheckbox=a.toggleCheckbox.bind(Object(h.a)(Object(h.a)(a))),a.loadingRender=a.loadingRender.bind(Object(h.a)(Object(h.a)(a))),a.getNeedHelp=a.getNeedHelp.bind(Object(h.a)(Object(h.a)(a))),a.loginStatus=a.loginStatus.bind(Object(h.a)(Object(h.a)(a))),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=p.a.load("remember");if(e){var t=L.a.AES.decrypt(e,"secret key 123"),a=JSON.parse(t.toString(L.a.enc.Utf8));this.setState({email:a.email,password:a.password,remember:!0})}}},{key:"loadingRender",value:function(){return l.a.createElement("div",{className:"text-center"},Object(U.c)())}},{key:"loginStatus",value:function(){var e=this.props,t=e.fetching,a=e.fetched,n=e.userLoginError;return t||a&&null===n?l.a.createElement("div",{className:"login-status"},this.loadingRender()):a&&n&&0!==n.length?l.a.createElement("div",{className:"text-center"},l.a.createElement("p",null,n.data)):void 0}},{key:"getNeedHelp",value:function(){var e=this.props,t=e.fetchingSupportEmail,a=e.fetchedSupportEmail,n=e.supportEmail;return t?l.a.createElement("div",{className:"need-help"},this.loadingRender()):a&&n?l.a.createElement("div",{className:v()("need-help",{disabled:0===n.length||""===n.URL})},l.a.createElement("a",{href:"mailto:".concat(n)},_.s)):void 0}},{key:"render",value:function(){var e=this;return this.props.isOpen&&!1!==this.props.isOpen?l.a.createElement(f.d,{initialValues:{email:this.state.email,password:this.state.password},validate:function(e){var t={};return e.email?/\s?\w+\s/i.test(e.email)&&(t.email="Invalid username"):t.email="Required",e.password||(t.password="Required"),t},onSubmit:function(t,a){var n=a.setSubmitting;setTimeout(function(){n(!1),e.handleLoginSubmit(t)},400)},enableReinitialize:!0},function(t){var a=t.isSubmitting;return l.a.createElement(f.c,{className:v()({disabled:e.props.fetching||e.props.fetched&&null===e.props.userLoginError})},e.loginStatus(),l.a.createElement(f.b,{type:"text",name:"email",placeholder:"Username"}),l.a.createElement(f.a,{name:"email",component:"div",className:"error-msg"}),l.a.createElement(f.b,{type:"password",name:"password",placeholder:"Password"}),l.a.createElement(f.a,{name:"password",component:"div",className:"error-msg"}),l.a.createElement("div",{className:v()("more-link",{"d-none":!e.state.show})},l.a.createElement("button",{type:"submit",className:v()("btn btn-outline-secondary text-uppercase",{disabled:a})},_.E)),l.a.createElement("div",{className:"extended"},l.a.createElement(E.b,{className:"forget-password",to:"/reset-password"},_.e),l.a.createElement(b.a,{check:!0,for:"remember-me",className:v()({active:e.state.remember})},l.a.createElement(y.a,{type:"checkbox",id:"remember-me",name:"remember_me",onChange:e.toggleCheckbox}),_.x)),e.getNeedHelp())}):null}}]),t}(c.Component),R=a(153),F=a(513),C=a(499),j=a(500),A=a(149),w=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("section",{className:"loading"},l.a.createElement("img",{className:"loading-icon",src:A.e,alt:"loader"}))}}]),t}(c.Component),N=(a(527),a(48)),I=a.n(N),D=a(69),T=Object(D.a)();var P={updateUserFlag:function(e){return T?T.headers["X-CSRF-Token"]=p.a.load("csrfToken"):T={headers:{Authorization:"".concat(e.tokenType," ").concat(e.accessToken),"X-CSRF-Token":p.a.load("csrfToken")}},function(e){e({type:"UPDATE_USER_FLAG"}),I.a.post("/api/v1/userPolicyFlag?_format=json",{flagStatus:1},T).then(function(t){e({type:"UPDATE_USER_FLAG_SUCCESS",payload:t.data})}).catch(function(t){e({type:"UPDATE_USER_FLAG_FAILURE",payload:t.response.data.message}),e({type:"ADD_ERROR",payload:t})})}}},x=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).acceptLogin=function(){a.state.agree1&&a.state.agree2&&a.props.updateUserFlag(a.props.userLoginCredentails)},a.toggleCheckbox=function(e){var t=document.getElementById(e.target.id),n=e.target.name,r=t.checked;a.setState(Object(R.a)({},n,r))},a.logout=function(){a.setState({logout:!0}),a.props.logout()},a.state={agree1:!1,agree2:!1,active:!1},a.logout=a.logout.bind(Object(h.a)(Object(h.a)(a))),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){Object(U.d)()}},{key:"componentWillReceiveProps",value:function(e){if(e.updateUserFlag)if(e.userFlag)e.redirectLogin();else{var t=localStorage.getItem("user");if(t){var a=JSON.parse(t);a.policyFlag=!0,localStorage.setItem("user",JSON.stringify(a))}}}},{key:"render",value:function(){var e=this.props,t=e.isOpen,a=e.updatingUserFlag,n=e.updatedUserFlag;return l.a.createElement(F.a,{className:"tool-modal",isOpen:t,centered:!0},a||this.state.logout||n?l.a.createElement("div",{className:"loader text-center"},Object(U.c)()):null,l.a.createElement("div",{className:"modal-header"},l.a.createElement("button",{type:"button",onClick:this.logout,className:"close"},l.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),t?l.a.createElement(C.a,null,l.a.createElement(j.a,{check:!0},l.a.createElement(b.a,{check:!0,for:"agree1",className:v()({active:this.state.agree1}),disabled:a},l.a.createElement(y.a,{type:"checkbox",id:"agree1",name:"agree1",value:this.state.agree1,onChange:this.toggleCheckbox}),"I have read, understand and agree to the ",l.a.createElement("a",{href:"/terms-and-conditions",target:"_blank"},"terms and conditions"))),l.a.createElement(j.a,{check:!0},l.a.createElement(b.a,{check:!0,for:"agree2",className:v()({active:this.state.agree2})},l.a.createElement(y.a,{type:"checkbox",id:"agree2",name:"agree2",value:this.state.agree2,onChange:this.toggleCheckbox,disabled:a})," ","I have read, understand and agree to the privacy policy. Personal data will be used to create and manage your account, including to send transactional emails about your account. Personal data may be stored outside your country of residence. For more information on our privacy practices, your rights and hour to exercise these rights. Please see our ",l.a.createElement("a",{href:"/privacy-policy",target:"_blank"},"Privacy Policy."))),l.a.createElement(g.a,{className:"text-center"},l.a.createElement("div",{className:"col more-link"},l.a.createElement("button",{className:v()("btn btn-outline-secondary text-uppercase",{active:this.state.agree1&&this.state.agree2},{disabled:!(this.state.agree1&&this.state.agree2)}),onClick:this.acceptLogin},"Accept")))):l.a.createElement(w,null))}}]),t}(c.Component);x.defaultProps={isOpen:!1};var B=Object(u.b)(function(e){var t=e.userFlag;return{updatingUserFlag:t.updatingUserFlag,updatedUserFlag:t.updatedUserFlag,userFlag:t.userFlag,userFlagError:t.userFlagError}},function(e){return{updateUserFlag:function(t){return e(P.updateUserFlag(t))}}})(x),G=(a(528),a(529)),M=a(525),H=Object(D.a)();var J={getUserInfo:function(e){return H||(H={headers:{Authorization:"".concat(e.tokenType," ").concat(e.accessToken)}}),function(e){e({type:"FETCH_USER_DETAILS"}),I.a.get("/api/v1/userDashboard?_format=json",H).then(function(t){e({type:"FETCH_USER_DETAILS_SUCCESS",payload:t.data}),localStorage.setItem("user",JSON.stringify(t.data))}).catch(function(t){e({type:"FETCH_USER_DETAILS_FAILURE",payload:t.response.data.message}),e({type:"ADD_ERROR",payload:t})})}}},W=a(530),z=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(i.a)(t).call(this,e))).redirectLogin=function(){document.location=A.b},a.toggleAcceptModal=function(){var e=!a.state.showAcceptModal;a.setState({showAcceptModal:e})},a.toggleForgot=function(){a.setState({showForgot:!a.state.showForgot})},a.state={background:"rgba(0,0,0,0.3)",true:!1,auth_in_progress:!1,showAcceptModal:!1,cred:!1,showForgot:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=p.a.load("access_token",{path:"/"});e&&(this.props.getUserInfo(e),this.setState({active:!0})),this.props.getLoginBackground(),this.props.getGlobalSupportEmail()}},{key:"componentWillReceiveProps",value:function(e){var t=e.AuthenticatedUserCredentails,a=e.AuthenticatingUserCredentails,n=e.userLoginCredentails;if(void 0!==e.loginBackground.backGroundImage&&this.setState({background:e.loginBackground.backGroundImage}),a)this.setState({cred:!0});else if(t&&this.state.cred&&n&&""!==n.length){var r=JSON.stringify(n),o=new Date(new Date(0).setUTCSeconds(n.expiresIn));p.a.save("access_token",r,{path:"/",expires:o}),this.setState({cred:!1}),e.getUserInfo(n)}e.fetchedUserDetails&&(e.user&&e.user.policyFlag?(localStorage.setItem("user",JSON.stringify(e.user)),this.redirectLogin()):this.setState({showAcceptModal:!0}))}},{key:"render",value:function(){var e=this.props,t=e.AuthenticatedUserCredentails,a=e.AuthenticatingUserCredentails,n=e.fetchedFooter,r=e.fetchingFooter,o=e.footer,i=e.userLoginError,s=e.fetchingSupportEmail,c=e.fetchedSupportEmail,u=e.supportEmail;return l.a.createElement(g.a,null,l.a.createElement("div",{className:"user-login-wrapper col-12",style:{backgroundImage:"url("+this.state.background+")"}},l.a.createElement(M.a,null),l.a.createElement("div",{className:"user-login"},l.a.createElement(k,{isOpen:!this.state.showForgot,onSubmitForm:this.toggleAcceptModal,login:this.props.submitLogin,fetching:a||this.state.active,fetched:t,userLoginError:i,fetchedFooter:n,fetchingFooter:r,footer:o,toggleForgot:this.toggleForgot,supportEmail:u,fetchedSupportEmail:c,fetchingSupportEmail:s}),l.a.createElement(B,{isOpen:this.state.showAcceptModal,toggle:this.toggleAcceptModal,logout:this.props.logout,redirectLogin:this.redirectLogin,userLoginCredentails:this.props.userLoginCredentails,user:this.props.user}))))}}]),t}(c.Component);var K=Object(u.b)(function(e){var t=e.userLogin,a=t.fetchingLoginBackground,n=t.fetchedLoginBackground,r=t.userLoginError,o=t.loginBackground,i=t.AuthenticatingUserCredentails,s=t.AuthenticatedUserCredentails,c=t.fetchingLogoutInfo,l=t.fetchedLogoutInfo,u=t.userLogout,d=t.userLoginCredentails,p=e.footer,g=p.fetchedFooter,m=p.fetchingFooter,h=p.footer,f=e.support,E=f.fetchingSupportEmail,b=f.fetchedSupportEmail,y=f.supportError,S=f.supportEmail,v=e.userDetails;return{fetchingLoginBackground:a,fetchedLoginBackground:n,userLoginError:r,loginBackground:o,AuthenticatingUserCredentails:i,AuthenticatedUserCredentails:s,fetchingLogoutInfo:c,fetchedLogoutInfo:l,userLogout:u,fetchedFooter:g,fetchingFooter:m,footer:h,userLoginCredentails:d,fetchingSupportEmail:E,fetchedSupportEmail:b,supportError:y,supportEmail:S,fetchingUserDetails:v.fetchingUserDetails,fetchedUserDetails:v.fetchedUserDetails,user:v.user,userDetailsError:v.userDetailsError}},function(e){return{getLoginBackground:function(){return e(m.a.getLoginBackground())},submitLogin:function(t,a){return e(m.a.submitLogin(t,a))},logout:function(){return e(W.a.submitLogout())},getGlobalSupportEmail:function(){return e(G.a.getGlobalSupportEmail())},getUserInfo:function(t){return e(J.getUserInfo(t))}}})(z);t.default=K}}]);
//# sourceMappingURL=UserLogin.de526a0a.bundle.js.map